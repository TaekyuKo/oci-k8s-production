# ì»´í¬ë„ŒíŠ¸ ìƒì„¸ ì„¤ëª…

## ğŸ“¦ í•µì‹¬ ì»´í¬ë„ŒíŠ¸

### 1. Cilium (CNI)

**ì„ íƒ ì´ìœ :**
- eBPF ê¸°ë°˜ìœ¼ë¡œ ì»¤ë„ ìˆ˜ì¤€ì—ì„œ ë™ì‘ (ê³ ì„±ëŠ¥)
- NetworkPolicy ì™„ë²½ ì§€ì›
- Hubbleì„ í†µí•œ ë„¤íŠ¸ì›Œí¬ ê´€ì¸¡ì„±
- Service Mesh ê¸°ëŠ¥ í¬í•¨ (ì„ íƒì )

**ì„¤ì¹˜ ë°©ë²•:**
```bash
ansible-playbook playbooks/04-install-cilium.yml
```

**í™•ì¸:**
```bash
kubectl get pods -n kube-system -l k8s-app=cilium
cilium status
```

---

### 2. Kubernetes Gateway API

**ì„ íƒ ì´ìœ :**
- Kubernetes ê³µì‹ í‘œì¤€ (Ingress í›„ì†)
- ë©€í‹° ë²¤ë” ì§€ì› (Nginx, Envoy, Istio ë“±)
- ë” í’ë¶€í•œ ë¼ìš°íŒ… ê¸°ëŠ¥
- Role ê¸°ë°˜ ì ‘ê·¼ ì œì–´

**vs Nginx Ingress:**
| íŠ¹ì§• | Gateway API | Nginx Ingress |
|------|-------------|---------------|
| í‘œì¤€í™” | âœ… K8s í‘œì¤€ | âŒ ì‚¬ì‹¤ìƒ í‘œì¤€ |
| í™•ì¥ì„± | âœ… ìš°ìˆ˜ | âš ï¸ ì œí•œì  |
| ë©€í‹° í…Œë„ŒíŠ¸ | âœ… ë„¤ì´í‹°ë¸Œ ì§€ì› | âš ï¸ ë³µì¡ |
| í•™ìŠµ ê³¡ì„  | âš ï¸ ì•½ê°„ ë†’ìŒ | âœ… ë‚®ìŒ |

**ì„¤ì¹˜:**
```bash
ansible-playbook playbooks/06-install-gateway-api.yml
```

---

### 3. Prometheus + Grafana

**Prometheus:**
- ì‹œê³„ì—´ ë°ì´í„°ë² ì´ìŠ¤
- Pull ë°©ì‹ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
- PromQL ì¿¼ë¦¬ ì–¸ì–´
- AlertManager ì—°ë™

**Grafana:**
- ì‹œê°í™” ëŒ€ì‹œë³´ë“œ
- ë‹¤ì–‘í•œ ë°ì´í„° ì†ŒìŠ¤ ì§€ì›
- ì•Œë¦¼ ê¸°ëŠ¥

**ê¸°ë³¸ ëŒ€ì‹œë³´ë“œ:**
- Kubernetes Cluster Monitoring
- Node Exporter Full
- Cilium Metrics

**ì ‘ì†:**
```bash
# Grafana: http://<master-ip>:30000
# Prometheus: http://<master-ip>:30090
```

---

### 4. Loki + Promtail

**ì„ íƒ ì´ìœ  (vs EFK Stack):**
| íŠ¹ì§• | Loki | Elasticsearch |
|------|------|---------------|
| ë¦¬ì†ŒìŠ¤ | âœ… ê²½ëŸ‰ (500MB~) | âŒ ë¬´ê±°ì›€ (2GB+) |
| ìŠ¤í† ë¦¬ì§€ | âœ… ì €ë ´ | âŒ ë¹„ìŒˆ |
| ì„¤ì • | âœ… ê°„ë‹¨ | âŒ ë³µì¡ |
| ê²€ìƒ‰ | âš ï¸ ê¸°ë³¸ì  | âœ… ê°•ë ¥ |
| Grafana í†µí•© | âœ… ë„¤ì´í‹°ë¸Œ | âš ï¸ í”ŒëŸ¬ê·¸ì¸ |

**êµ¬ì„±:**
- **Loki**: ë¡œê·¸ ìˆ˜ì§‘ ë° ì €ì¥
- **Promtail**: ê° ë…¸ë“œì—ì„œ ë¡œê·¸ ì „ì†¡

**ì‚¬ìš©:**
```bash
# Grafanaì—ì„œ Loki ë°ì´í„° ì†ŒìŠ¤ë¡œ ë¡œê·¸ í™•ì¸
# LogQLë¡œ ì¿¼ë¦¬: {namespace="default"}
```

---

### 5. ArgoCD

**GitOps ì›Œí¬í”Œë¡œìš°:**
```
Git Repository (Source of Truth)
         â†“
    ArgoCD (ê°ì‹œ)
         â†“
Kubernetes Cluster (ìë™ ë°°í¬)
```

**ì£¼ìš” ê¸°ëŠ¥:**
- Gitì„ í†µí•œ ì„ ì–¸ì  ë°°í¬
- ìë™ ë™ê¸°í™”
- ë¡¤ë°± ì§€ì›
- Multi-cluster ê´€ë¦¬

**ì´ˆê¸° ì ‘ì†:**
```bash
# ë¹„ë°€ë²ˆí˜¸ í™•ì¸
kubectl -n argocd get secret argocd-initial-admin-secret \
  -o jsonpath="{.data.password}" | base64 -d

# ì ‘ì†: https://<master-ip>:30080
# ID: admin
```

---

### 6. Sealed Secrets

**ë¬¸ì œ:**
- Kubernetes Secretì€ base64 ì¸ì½”ë”© (ì•”í˜¸í™” ì•„ë‹˜)
- Gitì— Secretì„ ì˜¬ë¦´ ìˆ˜ ì—†ìŒ

**í•´ê²°:**
- Sealed Secret: ê³µê°œí‚¤ë¡œ ì•”í˜¸í™”
- Gitì— ì•ˆì „í•˜ê²Œ ì €ì¥ ê°€ëŠ¥
- í´ëŸ¬ìŠ¤í„°ì—ì„œë§Œ ë³µí˜¸í™” ê°€ëŠ¥

**ì‚¬ìš© ì˜ˆì‹œ:**
```bash
# Secret ìƒì„±
kubectl create secret generic mysecret --dry-run=client \
  --from-literal=password=mysecretpassword -o yaml | \
  kubeseal -o yaml > mysealedsecret.yaml

# Gitì— ì»¤ë°‹
git add mysealedsecret.yaml
git commit -m "Add sealed secret"

# ArgoCDê°€ ìë™ ë°°í¬ â†’ í´ëŸ¬ìŠ¤í„°ì—ì„œ ë³µí˜¸í™”
```

---

### 7. Cert-Manager

**ìë™í™”:**
1. Let's Encryptì— ì¸ì¦ì„œ ìš”ì²­
2. HTTP-01 ë˜ëŠ” DNS-01 ì±Œë¦°ì§€ ìˆ˜í–‰
3. ì¸ì¦ì„œ ë°œê¸‰ ë° ì €ì¥
4. ë§Œë£Œ ì „ ìë™ ê°±ì‹ 

**ì„¤ì • ì˜ˆì‹œ:**
```yaml
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: your-email@example.com
    privateKeySecretRef:
      name: letsencrypt-prod
    solvers:
    - http01:
        ingress:
          class: gateway
```

---

### 8. Helm

**ì—­í• :**
- Kubernetes íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €
- Chartë¥¼ í†µí•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬
- ë²„ì „ ê´€ë¦¬ ë° ë¡¤ë°±

**ì‚¬ìš© ì˜ˆì‹œ:**
```bash
# Chart ì„¤ì¹˜
helm install myapp stable/nginx

# ì—…ê·¸ë ˆì´ë“œ
helm upgrade myapp stable/nginx --set replicaCount=3

# ë¡¤ë°±
helm rollback myapp 1
```

---

## ğŸ”„ ì»´í¬ë„ŒíŠ¸ ê°„ í†µí•©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Git Repository                 â”‚
â”‚         (Manifests, Helm Charts)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“ (GitOps)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ArgoCD                         â”‚
â”‚      (ìë™ ë°°í¬ ë° ë™ê¸°í™”)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Kubernetes Cluster                  â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Cilium  â”‚  â”‚ Gateway  â”‚  â”‚   Apps   â”‚ â”‚
â”‚  â”‚   (CNI)  â”‚  â”‚   API    â”‚  â”‚          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         Monitoring Layer             â”‚  â”‚
â”‚  â”‚  Prometheus â†’ Grafana (Metrics)      â”‚  â”‚
â”‚  â”‚  Loki â†’ Grafana (Logs)               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      Security & Automation           â”‚  â”‚
â”‚  â”‚  Sealed Secrets (ì•”í˜¸í™”)              â”‚  â”‚
â”‚  â”‚  Cert-Manager (SSL ìë™í™”)            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰

| ì»´í¬ë„ŒíŠ¸ | CPU | Memory | ë¹„ê³  |
|---------|-----|--------|------|
| Cilium | 200m | 500MB | CNI |
| Prometheus | 500m | 2GB | ë©”íŠ¸ë¦­ ì €ì¥ |
| Grafana | 100m | 200MB | ëŒ€ì‹œë³´ë“œ |
| Loki | 200m | 500MB | ë¡œê·¸ ì €ì¥ |
| Promtail | 100m | 128MB | ê° ë…¸ë“œ |
| ArgoCD | 500m | 1GB | GitOps |
| Sealed Secrets | 50m | 64MB | ê²½ëŸ‰ |
| Cert-Manager | 100m | 128MB | ì¸ì¦ì„œ |
| Gateway API | 200m | 256MB | Ingress |

**ì´í•©:** ~3-4GB ë©”ëª¨ë¦¬ ì‚¬ìš© (ë…¸ë“œë‹¹)

**ê¶Œì¥ ì‚¬ì–‘:** Master 12GB, Worker 12GB (í”„ë¦¬í‹°ì–´ ìµœëŒ€)
